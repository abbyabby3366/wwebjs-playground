import"../chunks/CWj6FrbW.js";import{i as lt}from"../chunks/DbVienwh.js";import{p as nt,o as pt,f as x,h as ct,l as m,a as u,b as dt,$ as ut,c as o,e as s,s as n,m as E,g as t,r as i,w as J,u as L,x as vt,j as R,v as j,i as q,k as z}from"../chunks/CPPbwToL.js";import{i as F}from"../chunks/BBMtWJJw.js";import{e as B,i as H}from"../chunks/HMgc3kw4.js";import{r as K,b as Q}from"../chunks/DF61nx8T.js";var gt=x('<div class="col-span-full text-center py-10"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-2"></div> <p class="text-gray-500">Loading groups...</p></div>'),bt=x('<div class="col-span-full text-center py-10"><div class="text-4xl mb-3">ðŸ‘¥</div> <h3 class="text-lg font-medium mb-2">No groups yet</h3> <p class="text-sm mb-4 text-gray-500">Create your first WhatsApp group to get started</p> <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm">Create First Group</button></div>'),mt=x('<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold"> </h3> <span class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-800">Active</span></div> <div class="flex items-center justify-between text-sm text-gray-500 mb-4"><span> </span> <span> </span></div> <div class="mt-4 flex space-x-2"><button class="px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 text-sm">Open Chat</button> <button class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-sm">Manage</button></div></div>'),ft=x('<button class="px-3 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 text-sm">Remove</button>'),xt=x('<div class="flex space-x-2 mb-2"><input placeholder="Phone number" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"/> <!></div>'),ht=x('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"><div class="bg-white rounded-lg p-6 max-w-md w-full mx-4"><h3 class="text-lg font-semibold mb-4">Create New Group</h3> <div class="space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Group Title</label> <input placeholder="Enter group title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"/></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">Participants</label> <!> <button class="px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-sm">+ Add Participant</button></div></div> <div class="flex justify-end space-x-3 mt-6"><button class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200">Cancel</button> <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50">Create Group</button></div></div></div>'),yt=x('<div class="container mx-auto p-6 max-w-6xl"><div class="flex justify-between items-center mb-6"><div><h1 class="text-3xl font-bold text-gray-900">WhatsApp Groups</h1> <p class="text-gray-600">Create and manage your WhatsApp groups</p></div> <button class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Create New Group</button></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><!></div> <!></div>');function jt(U,V){nt(V,!1);let h=E([]),N=E(!1),k=E(!1),a=E({title:"",participants:[""]});pt(async()=>{await D()});async function D(){n(N,!0);try{const e=await(await fetch("/api/whatsapp/groups")).json();e.success?(n(h,e.groups||[]),console.log("Groups loaded:",t(h))):(console.error("Failed to load groups:",e.error),n(h,[]))}catch(r){console.error("Error loading groups:",r),n(h,[])}finally{n(N,!1)}}function X(){j(a,t(a).participants=[...t(a).participants,""])}function Y(r){j(a,t(a).participants=t(a).participants.filter((e,l)=>l!==r))}function Z(r,e){j(a,t(a).participants[r]=e),j(a,t(a).participants=[...t(a).participants])}async function tt(){if(!t(a).title.trim())return;const r=t(a).participants.map(e=>e.trim()).filter(e=>e.length>0);if(r.length===0){alert("Please add at least one participant");return}try{const l=await(await fetch("/api/whatsapp/create-group",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t(a).title.trim(),participants:r})})).json();l.success?(console.log("Group created successfully:",l),await D(),n(a,{title:"",participants:[""]}),n(k,!1),alert("Group created successfully!")):(console.error("Failed to create group:",l.error),alert(`Failed to create group: ${l.error}`))}catch(e){console.error("Error creating group:",e),alert(`Error creating group: ${e.message}`)}}lt();var W=yt();ct(r=>{ut.title="Groups - WhatsApp Chat Portal"});var M=s(W),at=o(s(M),2);i(M);var O=o(M,2),et=s(O);{var rt=r=>{var e=gt();u(r,e)},st=r=>{var e=J(),l=L(e);{var C=p=>{var c=bt(),y=o(s(c),6);i(c),m("click",y,()=>n(k,!0)),u(p,c)},P=p=>{var c=J(),y=L(c);B(y,1,()=>t(h),H,(T,v)=>{var _=mt(),w=s(_),g=s(w),I=s(g,!0);i(g),q(2),i(w);var d=o(w,2),f=s(d),G=s(f);i(f);var A=o(f,2),S=s(A);i(A),i(d);var b=o(d,2),$=s(b);q(2),i(b),i(_),R(()=>{z(I,t(v).name||t(v).title),z(G,`${(t(v).participantsCount||0)??""} participants`),z(S,`ID: ${t(v).id??""}`)}),m("click",$,()=>window.location.href=`/chat?group=${t(v).id}`),u(T,_)}),u(p,c)};F(l,p=>{t(h).length===0?p(C):p(P,!1)},!0)}u(r,e)};F(et,r=>{t(N)?r(rt):r(st,!1)})}i(O);var it=o(O,2);{var ot=r=>{var e=ht(),l=s(e),C=o(s(l),2),P=s(C),p=o(s(P),2);K(p),i(P);var c=o(P,2),y=o(s(c),2);B(y,1,()=>t(a).participants,H,(g,I,d)=>{var f=xt(),G=s(f);K(G);var A=o(G,2);{var S=b=>{var $=ft();m("click",$,()=>Y(d)),u(b,$)};F(A,b=>{t(a).participants.length>1&&b(S)})}i(f),Q(G,()=>t(a).participants[d],b=>(t(a).participants[d]=b,vt(()=>t(a)))),m("input",G,()=>Z(d,t(a).participants[d])),u(g,f)});var T=o(y,2);i(c),i(C);var v=o(C,2),_=s(v),w=o(_,2);i(v),i(l),i(e),R(g=>w.disabled=g,[()=>!t(a).title.trim()||t(a).participants.length===0]),Q(p,()=>t(a).title,g=>j(a,t(a).title=g)),m("click",T,X),m("click",_,()=>n(k,!1)),m("click",w,tt),u(r,e)};F(it,r=>{t(k)&&r(ot)})}i(W),m("click",at,()=>n(k,!0)),u(U,W),dt()}export{jt as component};
